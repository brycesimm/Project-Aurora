<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:Aurora.Shared.Models;assembly=Aurora.Shared"
             xmlns:local="clr-namespace:Aurora"
             x:Class="Aurora.MainPage"
             BackgroundColor="#F0F0F0">

    <!-- Removed outer ScrollView to prevent scroll conflict -->
    <CollectionView ItemsSource="{Binding DailyPicks}" 
                    x:DataType="local:MainPage"
                    SelectionMode="None">
        
        <!-- The "Header" scrolls with the list, acting as our top section -->
        <CollectionView.Header>
            <VerticalStackLayout Padding="20" Spacing="25">
                <Frame Padding="15" CornerRadius="10" HasShadow="True">
                    <VerticalStackLayout Spacing="10">
                        <Label
                            Text="Vibe of the Day"
                            FontSize="Large"
                            FontAttributes="Bold"
                            TextColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource Secondary}}" />
                        
                        <!-- Dynamic Vibe Content -->
                        <Label
                            Text="{Binding VibeOfTheDay.Title}"
                            FontSize="Medium"
                            FontAttributes="Bold"
                            TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" />
                        <Image
                            Source="{Binding VibeOfTheDay.ImageUrl}"
                            Aspect="AspectFill"
                            HeightRequest="150"
                            HorizontalOptions="FillAndExpand" />
                        <Label
                            Text="{Binding VibeOfTheDay.Snippet}"
                            FontSize="Medium"
                            TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" />

                        <Button 
                            x:Name="ReactionButton"
                            Text="{Binding VibeOfTheDay.UpliftCount, StringFormat='Uplifted Me ({0})'}"
                            Clicked="OnReactionButtonClicked"
                            HorizontalOptions="Start">
                            <Button.ImageSource>
                                <FontImageSource 
                                    FontFamily="MDI"
                                    Glyph="&#xF02D5;"
                                    Color="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Black}}" />
                            </Button.ImageSource>
                        </Button>
                    </VerticalStackLayout>
                </Frame>
                
                <Label Text="Daily Picks" 
                       FontSize="Large" 
                       FontAttributes="Bold" 
                       Margin="0,10,0,0"
                       TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
            </VerticalStackLayout>
        </CollectionView.Header>

        <!-- The List Items -->
        <CollectionView.ItemTemplate>
            <DataTemplate x:DataType="models:ContentItem">
                <VerticalStackLayout Padding="20,0,20,15">
                    <Frame Padding="15" CornerRadius="10" HasShadow="True">
                        <VerticalStackLayout Spacing="5">
                            <Label
                                Text="{Binding Title}"
                                FontSize="Medium"
                                FontAttributes="Bold"
                                TextColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource Secondary}}" />
                            <Label
                                Text="{Binding Snippet}"
                                FontSize="Small"
                                TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" />
                            <Button 
                                Text="{Binding UpliftCount, StringFormat='Uplifted Me ({0})'}"
                                Clicked="OnReactionButtonClicked"
                                HorizontalOptions="Start"
                                Margin="0,10,0,0">
                                <Button.ImageSource>
                                    <FontImageSource 
                                        FontFamily="MDI"
                                        Glyph="&#xF02D5;"
                                        Color="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Black}}" />
                                </Button.ImageSource>
                            </Button>
                        </VerticalStackLayout>
                    </Frame>
                </VerticalStackLayout>
            </DataTemplate>
        </CollectionView.ItemTemplate>
    </CollectionView>

</ContentPage>