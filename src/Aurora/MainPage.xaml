<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:Aurora.Shared.Models;assembly=Aurora.Shared"
             xmlns:local="clr-namespace:Aurora"
             x:Class="Aurora.MainPage"
             Title="Aurora">

    <CollectionView ItemsSource="{Binding DailyPicks}" 
                    x:DataType="local:MainPage"
                    SelectionMode="None">
        
        <CollectionView.Header>
            <VerticalStackLayout Padding="24" Spacing="24">
                <Border Padding="20">
                    <VerticalStackLayout Spacing="12">
                        <!-- Vibe Tag Pill -->
                        <Border BackgroundColor="{StaticResource VibeAccent}"
                                StrokeShape="RoundRectangle 20"
                                Padding="12,4"
                                HorizontalOptions="Start"
                                StrokeThickness="0">
                            <Label Text="VIBE OF THE DAY"
                                   Style="{StaticResource TagLabel}" />
                        </Border>
                        
                        <Label
                            Text="{Binding VibeOfTheDay.Title}"
                            Style="{StaticResource DisplayTitle}" />
                        
                        <Border StrokeShape="RoundRectangle 12" Padding="0" Margin="0,4">
                           <Image
                               Source="{Binding VibeOfTheDay.ImageUrl}"
                               Aspect="AspectFill"
                               HeightRequest="180"
                               HorizontalOptions="Fill" />
                        </Border>

                        <Label
                            Text="{Binding VibeOfTheDay.Snippet}"
                            Style="{StaticResource Body1}" />

                        <HorizontalStackLayout Spacing="12" Margin="0,8,0,0">
                            <!-- READ Button -->
                            <Button 
                                Text="READ"
                                BackgroundColor="{AppThemeBinding Light={StaticResource MistPrimaryLight}, Dark={StaticResource MistPrimaryDark}}"
                                TextColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OnPrimaryDark}}" />

                            <!-- UPLIFT Button (Icon + Count) -->
                            <Button 
                                x:Name="ReactionButton"
                                Text="{Binding VibeOfTheDay.UpliftCount}"
                                Clicked="OnReactionButtonClicked"
                                BackgroundColor="{StaticResource UpliftAccent}"
                                TextColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OnUpliftDark}}">
                                <Button.ImageSource>
                                    <FontImageSource 
                                        FontFamily="MDI"
                                        Glyph="&#xF02D5;"
                                        Color="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OnUpliftDark}}" />
                                </Button.ImageSource>
                            </Button>
                            
                            <!-- SHARE Button -->
                            <Button 
                                x:Name="ShareVibeButton"
                                Text="SHARE"
                                Clicked="OnShareClicked"
                                BackgroundColor="{StaticResource ShareAccent}"
                                TextColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OnShareDark}}">
                                <Button.ImageSource>
                                    <FontImageSource 
                                        FontFamily="MDI"
                                        Glyph="&#xF0497;"
                                        Color="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OnShareDark}}" />
                                </Button.ImageSource>
                            </Button>
                        </HorizontalStackLayout>
                    </VerticalStackLayout>
                </Border>
                
                <Label Text="Daily Picks" 
                       Style="{StaticResource Heading1}"
                       Margin="4,8,0,0" />
            </VerticalStackLayout>
        </CollectionView.Header>

        <CollectionView.ItemTemplate>
            <DataTemplate x:DataType="models:ContentItem">
                <VerticalStackLayout Padding="24,0,24,16">
                    <Border Padding="20">
                        <VerticalStackLayout Spacing="8">
                            <Label
                                Text="{Binding Title}"
                                Style="{StaticResource DisplayTitle}" />
                            <Label
                                Text="{Binding Snippet}"
                                Style="{StaticResource Body1}" />
                            
                            <HorizontalStackLayout Spacing="12" Margin="0,8,0,0">
                                <Button 
                                    Text="READ"
                                    BackgroundColor="{AppThemeBinding Light={StaticResource MistPrimaryLight}, Dark={StaticResource MistPrimaryDark}}"
                                    TextColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OnPrimaryDark}}" />

                                <Button 
                                    Text="{Binding UpliftCount}"
                                    Clicked="OnReactionButtonClicked"
                                    BackgroundColor="{StaticResource UpliftAccent}"
                                    TextColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OnUpliftDark}}">
                                    <Button.ImageSource>
                                        <FontImageSource 
                                            FontFamily="MDI"
                                            Glyph="&#xF02D5;"
                                            Color="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OnUpliftDark}}" />
                                    </Button.ImageSource>
                                </Button>

                                <Button 
                                    Text="SHARE"
                                    Clicked="OnShareClicked"
                                    BackgroundColor="{StaticResource ShareAccent}"
                                    TextColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OnShareDark}}">
                                    <Button.ImageSource>
                                        <FontImageSource 
                                            FontFamily="MDI"
                                            Glyph="&#xF0497;"
                                            Color="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OnShareDark}}" />
                                    </Button.ImageSource>
                                </Button>
                            </HorizontalStackLayout>
                        </VerticalStackLayout>
                    </Border>
                </VerticalStackLayout>
            </DataTemplate>
        </CollectionView.ItemTemplate>
    </CollectionView>

</ContentPage>